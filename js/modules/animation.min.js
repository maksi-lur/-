import *as mapFunction from "./map.js"; const animItems = document.querySelectorAll(".anim-item"), catalogImages = document.querySelectorAll(".main__catalog img[data-src],.main__catalog source[data-srcset]"), proectsImages = document.querySelectorAll(".main__proects img[data-src],.main__proects source[data-srcset]"), teamImages = document.querySelectorAll(".main__team img[data-src],.main__team source[data-srcset]"), blockCatalog = document.querySelector(".main__catalog"), blockProects = document.querySelector(".main__proects"), blockTeam = document.querySelector(".main__team"), loadMapBlock = document.querySelector(".footer__map-cities-block-map"); let indexMap = 1, wrapperBody = document.querySelector(".wrapper"); function animOnScroll() { if (0 < animItems.length) for (let e = 0; e < animItems.length; e++) { const n = animItems[e]; var a = n.offsetHeight, i = function (t) { t = t.getBoundingClientRect(); return { top: t.top + window.pageYOffset, right: t.right + window.pageXOffset, bottom: t.bottom + window.pageYOffset, left: t.left + window.pageXOffset } }(n).top; let t = window.innerHeight - a / 6; a > window.innerHeight && (t = window.innerHeight - window.innerHeight / 6), window.pageYOffset > i - t && window.pageYOffset < i + a && (wrapperBody.classList.contains("anim") ? (n.classList.add("item-active"), lazyScroll(e), n.classList.remove("data-image")) : wrapperBody.classList.contains("anim") || (n.classList.remove("item-active"), lazyScroll(e), n.classList.remove("data-image"))) } } const windowHeight = document.documentElement.clientHeight; function lazyLoadingCheck(t, e) { null !== t && (t = t.getBoundingClientRect().top + pageYOffset, pageYOffset > t - windowHeight && e.forEach(t => { t.dataset.src && (t.src = t.dataset.src, t.removeAttribute("data-src")), t.dataset.srcset && (t.srcset = t.dataset.srcset, t.removeAttribute("data-srcset")) })) } function lazyScroll(t) { animItems[t].classList.contains("main__catalog") && animItems[t].classList.contains("data-image") ? lazyLoadingCheck(blockCatalog, catalogImages) : animItems[t].classList.contains("main__proects") && animItems[t].classList.contains("data-image") ? lazyLoadingCheck(blockProects, proectsImages) : animItems[t].classList.contains("main__team") && animItems[t].classList.contains("data-image") ? lazyLoadingCheck(blockTeam, teamImages) : animItems[t].classList.contains("footer__map") && 1 == indexMap && getMap() } function getMap() { var t = loadMapBlock.getBoundingClientRect().top + pageYOffset; pageYOffset > t - windowHeight && (setTimeout(() => { mapFunction.initYmaps(), mapFunction.clickCity(), mapFunction.clickShop() }, 100), indexMap = 0) } export { animItems, animOnScroll };